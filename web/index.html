<!DOCTYPE html>
<html>
<head>
	<title>Visual Query Editor</title>

	<script src="https://unpkg.com/blockly/blockly_compressed.js"></script>
	<script src="https://unpkg.com/blockly/blocks_compressed.js"></script>
	<script src="https://unpkg.com/blockly/msg/en.js"></script>
    <script src="javascript_compressed.js"></script>


</head>
<body>
	<h1>Visual Query Editor</h1>

    <div style="widht=100%">
        <div id="blocklyDiv" style="display: inline-block; height: 480px; width: 58%;"></div>
        <textarea id="codebox" disabled="disabled" style="display: inline-block; height: 480px; width:38%"></textarea>
    </div>

	<xml id="toolbox" style="display: none">

        <category name="Logic" colour="%{BKY_LOGIC_HUE}">
            <block type="controls_if"></block>
			<block type="logic_compare"></block>
			<block type="logic_negate"></block>
	        <block type="logic_null"></block>
	        <block type="logic_ternary"></block>
        </category>
        <category name="Loops" colour="%{BKY_LOOPS_HUE}">
            <block type="controls_repeat_ext"></block>
        </category>
    
        <category name="Math" colour="%{BKY_MATH_HUE}">
            <block type="math_number"></block>
            <block type="math_arithmetic"></block>
        </category>   
        <category name="Text" colour="%{BKY_TEXTS_HUE}">
            <block type="text"></block>
		    <block type="text_print"></block>
        </category>
        <sep></sep>
        <category name="Variables" custom="VARIABLE" colour="%{BKY_VARIABLES_HUE}">
        </category>
        <category name="Functions" colour="%{BKY_PROCEDURES_HUE}">
            <block type="procedures_defnoreturn"></block>
            <block type="procedures_defreturn"></block>
            <block type="procedures_mutatorcontainer"></block>
        </category>

	</xml>

    
   
        
    

	<script>

		var workspace = Blockly.inject('blocklyDiv',
          {toolbox: document.getElementById('toolbox')});
          

        function myUpdateFunction(event) {
              var code = Blockly.JavaScript.workspaceToCode(workspace);
            document.getElementById('textarea').value = code;
        }
        workspace.addChangeListener(myUpdateFunction);

	</script>

</body>
</html>